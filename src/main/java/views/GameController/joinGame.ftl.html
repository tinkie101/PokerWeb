<#import "../layout/defaultLayout.ftl.html" as layout/>
<@layout.myLayout "New Multiplayer Page">

<script>
    function update()
    {
        $(document).ready(function(){
        if(document.getElementById("header") == null)
            return;
                $.ajax({
                        url: "/activeJoinGames",
                        type: "POST",
                        data: { roundID : ${roundID} }
                    })
                    .done(function( data ) {
                        $('#joinDiv').html( data );
                        if(data.split("selectDiv").length < 2)
                            return;
                        update();
                    });
        });
    }

    update();
</script>

<div id="joinDiv">
<#if waiting == 1>
    <div class="selectDiv" align="center">
        <h1 id="header">Waiting for host to start game.</h1>
        <table style="background-color: rgba(10, 10, 20, 0.3); margin:10px;">

            <th style="background-color: rgba(10, 10, 25, 0.3);">
                <thead>
                    <td style="color:yellow;">Players: </td>
                </thead>
            </th>

            <#list players as player>
                <tr>
                    <td>${player}</td>
                </tr>
            </#list>
        </table>

    </div>
<#else>
    <div class="gameDiv">
        <table class="table-hover" style="width:90%; margin:auto; margin-bottom:5px; background-color: rgba(100, 150, 200, 0.0);">
            <#assign userCount = 0/>
            <#list games as game>
                <#if userCount = game.roundID.winnerNum>
                    <tr class="info" id="winner">
                        <#else>
                            <tr class="info">
                </#if>
                <td>${game.username}</td>
                <td>
                    <#assign count = 1/>
                    <#list game.hand?split(",") as card>
                        <img class="card${count}" src='assets/images/cards/${card}.png' alt=${card} style='width:50px;height:80px; margin-top:2px; margin-bottom:2px;'>
                        <#assign count = count+1/>
                    </#list>
                </td>
                <td class="card4">${game.evaluate}</td>
                </tr>
                <#assign userCount = userCount + 1/>
            </#list>
        </table>
    </div>
</#if>
</div>

</@layout.myLayout>